const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/InfoCard-C7lsmvwW.js","assets/index-D69LMJuj.js","assets/@vue-DuLrxf2X.js","assets/vue-router-11agx4en.js","assets/nprogress-kPy6QMHr.js","assets/@kangc-gu18bvMu.js","assets/vue-DoXTYsZj.js","assets/@kangc-3hQqCbGp.css","assets/nprogress-IQvgPhqq.css","assets/element-plus-Ctj9zTtO.js","assets/lodash-es-CiJSjksT.js","assets/@vueuse-BuAFA7S7.js","assets/@element-plus-C3F0jtPG.js","assets/@popperjs-D9SI2xQl.js","assets/@ctrl-r5W6hzzQ.js","assets/dayjs-B2SHKluj.js","assets/async-validator-DKvM95Vc.js","assets/memoize-one-BdPwpGay.js","assets/normalize-wheel-es-B6fDCfyv.js","assets/@floating-ui-8uccrNCM.js","assets/element-plus-rtE9mq23.css","assets/pinia-SNm9yluJ.js","assets/vue-demi-Dq6ymT-8.js","assets/prismjs-3VRiJhH1.js","assets/highlight.js-B4C3kCeh.js","assets/index-iDc_Xa7b.css","assets/pl-BklRQY3T.js","assets/ws-C1Y02uT6.js","assets/index-BZ0-GGld.js","assets/request-KPIbsDrP.js","assets/axios-CCb-kr4I.js","assets/InfoCard-D9atABEK.css"])))=>i.map(i=>d[i]);
import{_ as _e,S as K,a as ye}from"./index-D69LMJuj.js";import{b as d,Z as q,k as be,j as ge,M as p,O as l,ai as r,o as n,a,U as t,S as m,u as F,T as xe,R as v,c as x,F as T,a8 as S,a2 as B,aV as we,n as ke}from"./@vue-DuLrxf2X.js";import{u as Ve,b as Ce}from"./vue-router-11agx4en.js";import{R as Fe,S as je,T as Ue,U as De,V as Ie}from"./@element-plus-C3F0jtPG.js";import{u as Le}from"./index-DhNvuj3N.js";import{E as b}from"./element-plus-Ctj9zTtO.js";import"./nprogress-kPy6QMHr.js";import"./@kangc-gu18bvMu.js";import"./vue-DoXTYsZj.js";import"./pinia-SNm9yluJ.js";import"./vue-demi-Dq6ymT-8.js";import"./prismjs-3VRiJhH1.js";import"./highlight.js-B4C3kCeh.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-BuAFA7S7.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-B2SHKluj.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-8uccrNCM.js";import"./request-KPIbsDrP.js";import"./axios-CCb-kr4I.js";import"./qs-DOx0cG2m.js";import"./side-channel-DmwB278a.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./call-bind-Bt3bzbWQ.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./object-inspect-Cx20fAzC.js";const Re={class:"w-[800px] bg-white rounded-sm"},Te={class:"flex items-center justify-between pl-10 pr-4"},Se={class:"h-[400px] flex justify-center items-center"},Ee={class:"w-[460px] flex justify-between"},he={key:1,class:"w-full h-[400px] p-4"},Pe={class:"flex justify-end pb-2"},Ne={class:"flex justify-center pb-2"},Ae={key:0},Oe={key:2,class:"w-full h-[400px] p-4"},qe={class:"flex justify-center"},Be={class:"w-[500px]"},Me={class:"mt-4"},Je={key:3,class:"w-[500px] h-[400px] p-4"},ze={class:"mt-4"},He={key:4,class:"w-[500px] h-[400px] p-4"},Ze={class:"flex justify-center items-center"},Ge={class:"flex justify-center p-4"},Ke={class:"flex justify-center font-sty p-4",style:{"background-color":"#D4DDF1"}},Qe={style:{padding:"30px"}},We={class:"flex justify-center font-sty"},Xe={__name:"config",setup(Ye){const Q=we(()=>ye(()=>import("./InfoCard-C7lsmvwW.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),i=d(0),c=q({value1:null,value2:null,value3:null}),D=d([]),k=Le(),E=Ve(),W=Ce(),V=d(!1),M=()=>{h(),E.push({path:"/home",query:{configId:I.value}}),V.value=!1},J=()=>{K.clear(),E.push({path:"/loginI"}),h()},_=d(""),I=d(""),z=d(K.get().is_admin),X=d(null),f=q({marksman_num:10,grade:"1",exer_duration:0}),Y=q({20:"",40:""}),$=()=>{if(window.navigator.clipboard&&window.isSecureContext)return window.navigator.clipboard.writeText(_.value).then(()=>{console.log("Text copied to clipboard"),b.success("验证码复制成功")}),window.navigator.clipboard.writeText(_.value);{const s=document.createElement("textarea");return s.value=_.value,document.body.appendChild(s),s.focus(),s.select(),b.success("验证码复制成功"),new Promise((e,u)=>{document.execCommand("copy")?e():u(),s.remove()})}},h=()=>{ke(()=>{_.value=""})},H=async()=>{if(z.value){if(!c.value1||!c.value2||!c.value3){b.warning("请选择演练阶段");return}ee()}else{const{data:s,status_code:e}=await k.joinRoom({invite_code:_.value});e===200&&(I.value=s[0].configure_id,M())}},ee=async()=>{V.value=!0;let s=JSON.parse(JSON.stringify(f));s.corpus_file_id=R.value;let u=Object.keys(c).map(g=>c[g]);s.topic_direction=u;const{data:y,status_code:N}=await k.initRoom(s);V.value=!1,N===200&&y[0]&&(b.success("创建成功"),_.value=y[0].invite_code,I.value=y[0].configure_id,i.value=4)},te=async()=>{const{data:s}=await k.getEventTypeList();D.value=s.filter(e=>e!==null)},le=()=>{switch(i.value){case 0:if(f.marksman_num<1){b.warning("请输入正确的水军数量");return}else if(f.exer_duration<1){b.warning("请输入正确的演练时长");return}break;case 1:if(!R.value){b.warning("请上传文件");return}break;case 2:if(!j.value){b.warning("请选择演练帖子");return}break}i.value<4&&i.value++},oe=()=>{i.value>0&&i.value--},ae=d(),L=d([]),R=d(),Z=d(),se=async()=>{if(L.value.length===0)return b.warning("请选择文件");const s=new FormData;L.value.forEach(y=>{s.append("corpus_file",y.raw)});const{data:e,status_code:u}=await k.uploadFile(s);u===200&&(b.success("上传成功"),R.value=e[0].file_id,Z.value=e[0])},P=d([]),j=d(),ne=be(()=>P.value.find(s=>s.uid===j.value)),ie=async()=>{const{count:s}=await k.getListData({limit:10,skip:0});if(s){const{data:e}=await k.getListData({limit:s,skip:0});P.value=e}},ue=()=>{h(),E.push({path:"/home",query:{configId:W.query.configId}}),V.value=!1};return ge(()=>{te(),ie()}),(s,e)=>{const u=r("el-button"),y=r("el-step"),N=r("el-steps"),g=r("el-option"),U=r("el-select"),w=r("el-form-item"),A=r("el-input"),re=r("el-tag"),de=r("el-slider"),pe=r("el-form"),me=r("el-upload"),C=r("el-table-column"),ce=r("el-table"),G=r("el-col"),fe=r("el-card"),ve=r("el-row");return n(),p(ve,null,{default:l(()=>[z.value?(n(),p(G,{key:0,offset:12,span:12,style:{height:"100vh"},class:"flex flex-col items-center justify-center"},{default:l(()=>[a("div",Re,[a("div",Te,[e[11]||(e[11]=a("div",{class:"welc text-center"},"创建演练室",-1)),t(u,{type:"info",link:"",onClick:ue},{default:l(()=>e[10]||(e[10]=[m(" 跳过 ")])),_:1})]),t(N,{class:"mb-4",space:200,active:i.value,simple:""},{default:l(()=>[t(y,{title:"演练设置",icon:F(Fe)},null,8,["icon"]),t(y,{title:"上传文件",icon:F(je)},null,8,["icon"]),t(y,{title:"演练帖子",icon:F(Ue)},null,8,["icon"]),t(y,{title:"舆情走向",icon:F(De)},null,8,["icon"])]),_:1},8,["active"]),a("div",Se,[i.value===0?(n(),p(pe,{key:0,class:"w-[500px] h-[400px] p-4","label-position":"top",ref_key:"ruleFormRef",ref:X,model:f,"hide-required-asterisk":!0},{default:l(()=>[t(w,{label:"演练难度",prop:"grade"},{default:l(()=>[t(U,{modelValue:f.grade,"onUpdate:modelValue":e[0]||(e[0]=o=>f.grade=o)},{default:l(()=>[t(g,{label:"初级",value:"1"}),t(g,{label:"中级",value:"2"}),t(g,{label:"高级",value:"3"})]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"水军数量",prop:"marksman_num"},{default:l(()=>[t(A,{type:"number",modelValue:f.marksman_num,"onUpdate:modelValue":e[1]||(e[1]=o=>f.marksman_num=o),step:"","controls-position":"right","step-strictly":""},null,8,["modelValue"])]),_:1}),t(w,{label:"演练时长（分钟）",prop:"exer_duration",style:{position:"relative"}},{label:l(()=>[a("div",Ee,[e[12]||(e[12]=a("span",null," 演练时长（分钟）",-1)),t(re,{round:"",type:"info"},{default:l(()=>[m(xe(f.exer_duration),1)]),_:1})])]),default:l(()=>[t(de,{modelValue:f.exer_duration,"onUpdate:modelValue":e[2]||(e[2]=o=>f.exer_duration=o),step:20,"show-stops":"",max:60,marks:Y},null,8,["modelValue","marks"])]),_:1})]),_:1},8,["model"])):v("",!0),i.value===1?(n(),x("div",he,[a("div",Pe,[t(u,{type:"primary",color:"#0058F9",onClick:se},{default:l(()=>e[13]||(e[13]=[m(" 确认上传 ")])),_:1})]),a("div",Ne,[t(me,{ref_key:"uploadRef",ref:ae,class:"upload-demo w-[500px]",drag:"","auto-upload":!1,"file-list":L.value,"onUpdate:fileList":e[3]||(e[3]=o=>L.value=o),limit:1,accept:".xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},{trigger:l(()=>e[14]||(e[14]=[a("div",{class:"el-upload__text"},[m(" 拖拽选择文件 或 "),a("em",null,"点击选择文件")],-1)])),_:1},8,["file-list"])]),R.value?(n(),x("div",Ae,[t(ce,{data:Z.value.parsed_data,height:180,stripe:"","show-overflow-tooltip":""},{default:l(()=>[t(C,{type:"index",width:"60",label:"#"}),t(C,{prop:"content",label:"语料内容"}),t(C,{prop:"notes",width:"150",label:"备注"}),t(C,{prop:"scenario",width:"120",label:"出现场景"}),t(C,{prop:"severity",width:"120",label:"严重程度"}),t(C,{prop:"speech_type",width:"120",label:"言论类型"})]),_:1},8,["data"])])):v("",!0)])):v("",!0),i.value===2?(n(),x("div",Oe,[a("div",qe,[a("div",Be,[e[15]||(e[15]=a("div",null," 请选择演练帖子： ",-1)),a("div",Me,[t(U,{modelValue:j.value,"onUpdate:modelValue":e[4]||(e[4]=o=>j.value=o),filterable:""},{default:l(()=>[(n(!0),x(T,null,S(P.value,(o,O)=>(n(),p(g,{label:o.title,value:o.uid},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])])])]),j.value?(n(),p(F(Q),{key:0,info:ne.value,ref:"infoCardRef",operationHide:!0},null,8,["info"])):v("",!0)])):v("",!0),i.value===3?(n(),x("div",Je,[e[16]||(e[16]=a("div",null," 请选择舆情走向： ",-1)),a("div",ze,[t(w,{label:"阶段一","label-position":"top"},{default:l(()=>[t(U,{modelValue:c.value1,"onUpdate:modelValue":e[5]||(e[5]=o=>c.value1=o)},{default:l(()=>[(n(!0),x(T,null,S(D.value,(o,O)=>(n(),p(g,{label:o,value:o},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"阶段二","label-position":"top"},{default:l(()=>[t(U,{modelValue:c.value2,"onUpdate:modelValue":e[6]||(e[6]=o=>c.value2=o)},{default:l(()=>[(n(!0),x(T,null,S(D.value,(o,O)=>(n(),p(g,{label:o,value:o},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(w,{label:"阶段三","label-position":"top"},{default:l(()=>[t(U,{modelValue:c.value3,"onUpdate:modelValue":e[7]||(e[7]=o=>c.value3=o)},{default:l(()=>[(n(!0),x(T,null,S(D.value,(o,O)=>(n(),p(g,{label:o,value:o},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})])])):v("",!0),i.value===4?(n(),x("div",He,[t(w,{label:"邀请码","label-position":"top"},{label:l(()=>[a("div",Ze,[e[17]||(e[17]=a("span",null," 邀请码",-1)),t(u,{title:"复制邀请码",size:"small",class:"ml-1",text:"",icon:F(Ie),onClick:$},null,8,["icon"])])]),default:l(()=>[t(A,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=o=>_.value=o),disabled:!0},null,8,["modelValue"])]),_:1})])):v("",!0)]),a("div",Ge,[i.value>0?(n(),p(u,{key:0,onClick:oe,color:"#0058F9"},{default:l(()=>e[18]||(e[18]=[m("上一步")])),_:1})):v("",!0),i.value<3?(n(),p(u,{key:1,type:"primary",color:"#0058F9",plain:"",onClick:le},{default:l(()=>e[19]||(e[19]=[m("下一步")])),_:1})):v("",!0),i.value===3?(n(),p(u,{key:2,color:"#0058F9",onClick:B(H,["prevent"]),loading:V.value},{default:l(()=>e[20]||(e[20]=[m("确认")])),_:1},8,["loading"])):v("",!0),i.value===4&&I.value?(n(),p(u,{key:3,class:"login-form__button",color:"#0058F9",plain:"",onClick:B(M,["prevent"])},{default:l(()=>e[21]||(e[21]=[m("进入系统")])),_:1})):v("",!0)]),a("div",Ke,[e[23]||(e[23]=m(" 切换账号？ ")),t(u,{link:"",type:"primary",onClick:J,style:{color:"#0058F9"}},{default:l(()=>e[22]||(e[22]=[m("重新登录")])),_:1})])])]),_:1})):(n(),p(G,{key:1,offset:12,span:12,style:{height:"100vh"},class:"flex flex-col items-center justify-center"},{default:l(()=>[t(fe,{class:"box-card"},{footer:l(()=>[a("div",We,[e[27]||(e[27]=m(" 切换账号？ ")),t(u,{link:"",type:"primary",onClick:J,style:{color:"#0058F9"}},{default:l(()=>e[26]||(e[26]=[m("重新登录")])),_:1})])]),default:l(()=>[a("div",Qe,[e[25]||(e[25]=a("div",{class:"welc"},"加入演练室",-1)),t(w,{label:"邀请码","label-position":"top"},{default:l(()=>[t(A,{modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=o=>_.value=o)},null,8,["modelValue"])]),_:1}),a("div",null,[t(u,{class:"login-form__button",color:"#0058F9",onClick:B(H,["prevent"]),loading:V.value},{default:l(()=>e[24]||(e[24]=[m("确认")])),_:1},8,["loading"])])])]),_:1})]),_:1}))]),_:1})}}},At=_e(Xe,[["__scopeId","data-v-004d3346"]]);export{At as default};
