import{i as O,j as R}from"./echarts-chn2sS2z.js";import{u as I}from"./index-BZ0-GGld.js";import{s as z}from"./pinia-SNm9yluJ.js";import{u as A}from"./ws-C1Y02uT6.js";import{_ as j}from"./index-D69LMJuj.js";import{b as r,j as D,c as g,U as d,O as l,ai as b,o as i,a as o,M as h,T as x,R as k,F as N,a8 as V}from"./@vue-DuLrxf2X.js";import"./zrender-SnHL3Ddq.js";import"./tslib-BDyQ-Jie.js";import"./request-KPIbsDrP.js";import"./axios-CCb-kr4I.js";import"./element-plus-Ctj9zTtO.js";import"./lodash-es-CiJSjksT.js";import"./@vueuse-BuAFA7S7.js";import"./@element-plus-C3F0jtPG.js";import"./@popperjs-D9SI2xQl.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-B2SHKluj.js";import"./@kangc-gu18bvMu.js";import"./vue-DoXTYsZj.js";import"./async-validator-DKvM95Vc.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-8uccrNCM.js";import"./vue-demi-Dq6ymT-8.js";import"./vue-router-11agx4en.js";import"./nprogress-kPy6QMHr.js";import"./prismjs-3VRiJhH1.js";import"./highlight.js-B4C3kCeh.js";const E={class:"flex flex-col h-full p-4"},F={class:"score"},P={class:"text-xl font-bold"},$=["innerHTML"],U={class:"font-bold"},W={class:"font-bold"},q=["innerHTML"],G=["innerHTML"],u=70,M=90,J={__name:"detail",setup(K){const w=A(),{ws:Q,roomId:c}=z(w),m=I(),p=r(),y=r(80),T=r(80);y.value=Math.floor(Math.random()*(M-u+1))+u,T.value=Math.floor(Math.random()*(M-u+1))+u;const L=async()=>{const s=await m.getBackground(c.value);if(s.data[0]){const t=s.data[0].replace(/(\})(,)/g,"$1").replace(/["{}]/g,"").replace(/(\。)(,)/g,"$1").replace(/\n\n/g,"<br>").replace(/\n/g,"<br>").replace(/^<br>\s*/,"");p.value=t}else p.value=null},f=r(),S=async()=>{const{status_code:s,data:t}=await m.getPublishScore({room_id:c.value});if(s===200&&t[0]){const e=t[0].replace(/\n/g,"<br>").replace(/(```)/g,"");f.value=e}else f.value=""},v=r(),B=async()=>{const s=R(v.value),{data:t}=await m.getReportChart(c.value);if(!t[0])return;let e=Object.keys(t[0]),a=[];e.forEach(H=>{a.push(t[0][H])});const n={xAxis:{type:"category",data:e},yAxis:{type:"value"},tooltip:{trigger:"axis"},series:[{data:a,type:"line",smooth:!0,showSymbol:!1,name:"热度"}]};s.setOption(n)},_=r(),C=async()=>{const{status_code:s,data:t}=await m.commentScore(c.value);s!==200||!t[0]||(_.value=t.map(e=>{var a;return{...e,comment_rating:(a=e.comment_rating)==null?void 0:a.replace(/\n\n/g,"<br>").replace(/\n/g,"<br>").replace(/^<br>\s*/,"").replace(/#/g,"").replace(/\*/g,"")}}))};return D(()=>{L(),S(),C(),setTimeout(()=>{B(),new ResizeObserver(t=>{for(const e of t)O(e.target).resize()}).observe(v.value)})}),(s,t)=>{const e=b("el-col"),a=b("el-row");return i(),g("div",E,[d(a,null,{default:l(()=>[d(e,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>t[0]||(t[0]=[o("div",{class:"title"}," 热度总体变化 ",-1)])),_:1}),d(e,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o("div",{style:{height:"400px"},ref_key:"lineRef",ref:v},null,512)]),_:1}),p.value?(i(),h(e,{key:0,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o("div",F,[o("div",P,x(y.value),1),t[1]||(t[1]=o("div",{class:"text-xs font-medium"},"事件背景评分",-1))]),t[2]||(t[2]=o("div",{class:"title"}," 事件背景 ",-1)),o("div",{innerHTML:p.value,class:"content"},null,8,$)]),_:1})):k("",!0),_.value?(i(),h(e,{key:1,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t[3]||(t[3]=o("div",{class:"title"}," 回复评价 ",-1)),(i(!0),g(N,null,V(_.value,n=>(i(),g("div",{key:n.id},[o("div",null,[o("div",U,"名称："+x(n.nickname),1),o("div",W,"内容："+x(n.process_content),1),o("div",{innerHTML:n.comment_rating,style:{padding:"5px 30px"}},null,8,q)])]))),128))]),_:1})):k("",!0),d(e,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t[4]||(t[4]=o("div",{class:"title"}," 权威发布 ",-1)),o("div",{class:"content",innerHTML:f.value},null,8,G)]),_:1})]),_:1})])}}},Tt=j(J,[["__scopeId","data-v-2c6212c1"]]);export{Tt as default};
